# Common Open Ports and Exploitation Methods for Windows Machines

| **Port** | **Service**                     | **Description**                                                                                          | **Tools/Exploitation Methods**                                                                                                                                                                                                 |
|----------|---------------------------------|----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 21       | FTP                             | Protocol for file transfer.                                                                             | If FTP allows anonymous access, it can be exploited to access sensitive files. Tools like `ftp`, `nmap` (`nmap -p 21 --script ftp-anon`), and `hydra` can be used for enumeration and brute force.                               |
| 1433     | SQL Server                      | Microsoft SQL Server database service.                                                                  | Can be exploited via SQL injection or brute force using tools like `sqlcmd`, `mssqlclient.py` from `impacket`, or `metasploit`. It may also be vulnerable to user enumeration or weak credentials.                             |
| 3306     | MySQL                           | MySQL database in mixed environments.                                                                   | Enumeration and brute force of credentials using `mysql`, `hydra`, or `metasploit`. It may also be vulnerable to SQL injection if connected to a web interface.                                                               |
| 8000/8080| HTTP Alternative/Web Servers     | Alternative web servers or APIs.                                                                       | Scanning web applications using tools like `nikto`, `gobuster`, `dirb`, and vulnerability analysis with `Burp Suite` or `OWASP ZAP`. Applications may be vulnerable to command injection or misconfigurations.                  |
| 9200     | Elasticsearch                   | Search and analytics service.                                                                          | If misconfigured, sensitive data can be accessed. Tools like `curl` or custom scripts are useful for interacting with its REST API.                                                                                            |
| 47001    | Windows Remote Management (HTTPS)| Variant of WinRM using HTTPS.                                                                          | Exploitation similar to port 5985/5986 with tools like `evil-winrm` or `crackmapexec`.                                                                                                  |
| 5985/5986| WinRM (HTTP/HTTPS)              | Windows remote management using WS-Management protocol.                                                | Tools like `evil-winrm`, `wmiexec.py` from `impacket`, or even `crackmapexec` can be used for enumeration and credential exploitation.                                                  |
| 389      | LDAP                            | Protocol for directory services (e.g., Active Directory).                                               | Enumeration of users and groups using `ldapsearch` or `impacket` scripts. It may be vulnerable to misconfigurations or weak credentials.                                                |
| 636      | LDAPS                           | Secure variant of LDAP.                                                                                | Similar methods as port 389, but using TLS/SSL. Tools like `ldapsearch` with SSL options can be useful.                                                                                  |
| 3268/3269| Global Catalog Service          | Catalog services for Active Directory.                                                                 | Enumeration of Active Directory information using tools like `ldapsearch` or `impacket` scripts.                                                                                        |
| 25       | SMTP                            | Mail service used for sending messages.                                                                | User and mail service enumeration using tools like `smtp-user-enum`, `nmap` (`nmap -p 25 --script smtp-enum-users`), or `metasploit`. May allow open relay or weak credentials.          |
| 53       | DNS                             | Domain Name System protocol.                                                                           | DNS zone enumeration using `nslookup`, `dig`, or `dnsenum`. Misconfigurations may allow zone transfers.                                                                                 |
| 88       | Kerberos                        | Authentication protocol in Windows domains.                                                            | Tools like `impacket` for attacks like ASREPRoasting or Kerberoasting to obtain password hashes of privileged accounts for cracking.                                                   |
| 139      | NetBIOS Session Service         | Protocol used in Windows networks for resource sharing such as files and printers.                      | Enumeration of shared resources with `smbclient`, `enum4linux`, and scanning with `nmap` (`nmap -p 139 --script smb-enum-shares,smb-enum-users`). Misconfigurations may expose sensitive files. |
| 445      | SMB (Server Message Block)      | Network protocol for sharing files, resources, and printers in Windows.                                | Exploitation of vulnerabilities like EternalBlue (MS17-010) with `Metasploit` or specific scripts (`exploit.py`). Tools like `smbmap`, `crackmapexec`, and `enum4linux` are useful for enumeration and detecting weak configurations. |
